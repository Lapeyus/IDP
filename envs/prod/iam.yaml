# ---
# apiVersion: iam.cnrm.cloud.google.com/v1beta1
# kind: IAMServiceAccount
# metadata:
#   annotations:
#     cnrm.cloud.google.com/project-id: iampolicy-dep-external-project
#   name: iampolicy-dep-external-project
---
apiVersion: iam.cnrm.cloud.google.com/v1beta1
kind: IAMCustomRole
metadata:
  annotations:
    cnrm.cloud.google.com/project-id: jvillarreal-sandbox-demo
  name: iamcustomrolesampleproject2
spec:
  title: CustomRole
  description: This role only contains two permissions - publish and update
  permissions:
    - pubsub.topics.publish
    - pubsub.topics.update
  stage: GA
---
apiVersion: iam.cnrm.cloud.google.com/v1beta1
kind: IAMPolicy
metadata:
  annotations:
    cnrm.cloud.google.com/project-id: jvillarreal-sandbox-demo
  name: iampolicy-sample-pubsubadmin
spec:
  resourceRef:
    kind: PubSubTopic
    name: pubsubsubscription-dep
    apiVersion: pubsub.cnrm.cloud.google.com/v1beta1
  bindings:
    - role: roles/editor
      members:
        - serviceAccount:devops-robot@jvillarreal-sandbox-demo.iam.gserviceaccount.com
    # - role: projects/jvillarreal-sandbox-demo/roles/iamcustomrolesampleproject2
    #   members:
    #     - user:joseph.villarreal@66degrees.com
---
apiVersion: iam.cnrm.cloud.google.com/v1beta1
kind: IAMPartialPolicy
metadata:
  annotations:
    cnrm.cloud.google.com/project-id: jvillarreal-sandbox-demo
  name: iampartialpolicy-sample-project
spec:
  resourceRef:
    apiVersion: resourcemanager.cnrm.cloud.google.com/v1beta1
    kind: Project
    # name: jvillarreal-sandbox-demo
    external: projects/jvillarreal-sandbox-demo
  bindings:
    - role: roles/storage.admin
      members:
        - member: serviceAccount:devops-robot@jvillarreal-sandbox.iam.gserviceaccount.com
    # - role: roles/editor
    #   members:
    #     - memberFrom:
    #         serviceAccountRef:
    #           name: joseph
---
apiVersion: iam.cnrm.cloud.google.com/v1beta1
kind: IAMPolicyMember
metadata:
  annotations:
    cnrm.cloud.google.com/project-id: jvillarreal-sandbox-demo
  name: test-iampolicymember
spec:
  resourceRef:
    apiVersion: resourcemanager.cnrm.cloud.google.com/v1beta1
    kind: Project
    external: projects/jvillarreal-sandbox-demo
  member: user:joseph.villarreal@66degrees.com
  role: roles/storage.admin
...